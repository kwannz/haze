<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Floating-point comparison utilities with epsilon tolerance."><title>haze_library::utils::float_compare - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="haze_library" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0 (ded5c06cf 2025-12-08)" data-channel="1.92.0" data-search-js="search-d69d8955.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module float_compare</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../haze_library/index.html">haze_<wbr>library</a><span class="version">1.1.3</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module float_<wbr>compare</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#overview" title="Overview">Overview</a></li><li><a href="#problem-statement" title="Problem Statement">Problem Statement</a></li><li><a href="#solution" title="Solution">Solution</a></li><li><a href="#available-functions" title="Available Functions">Available Functions</a></li><li><a href="#design-philosophy" title="Design Philosophy">Design Philosophy</a></li><li><a href="#when-to-use" title="When to Use">When to Use</a></li><li><a href="#examples" title="Examples">Examples</a></li><li><a href="#performance-characteristics" title="Performance Characteristics">Performance Characteristics</a></li><li><a href="#cross-references" title="Cross-References">Cross-References</a></li></ul><h3><a href="#constants">Module Items</a></h3><ul class="block"><li><a href="#constants" title="Constants">Constants</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In haze_<wbr>library::<wbr>utils</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">haze_library</a>::<wbr><a href="../index.html">utils</a></div><h1>Module <span>float_<wbr>compare</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/haze_library/utils/float_compare.rs.html#1-719">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Floating-point comparison utilities with epsilon tolerance.</p>
<h2 id="overview"><a class="doc-anchor" href="#overview">§</a>Overview</h2>
<p>This module provides robust floating-point comparison functions to handle
numerical precision issues that arise from floating-point arithmetic.
Direct comparisons like <code>== 0.0</code> or <code>!= 0.0</code> can fail due to rounding errors.</p>
<h2 id="problem-statement"><a class="doc-anchor" href="#problem-statement">§</a>Problem Statement</h2>
<p>Floating-point arithmetic is inherently imprecise. For example:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">let </span>result = <span class="number">0.1 </span>+ <span class="number">0.2</span>;
<span class="macro">assert!</span>(result == <span class="number">0.3</span>); <span class="comment">// ❌ This fails! result is 0.30000000000000004</span></code></pre></div><h2 id="solution"><a class="doc-anchor" href="#solution">§</a>Solution</h2>
<p>Use epsilon-based comparisons that account for small rounding errors:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>haze_library::utils::float_compare::{approx_eq, approx_zero};

<span class="kw">let </span>result = <span class="number">0.1 </span>+ <span class="number">0.2</span>;
<span class="macro">assert!</span>(approx_eq(result, <span class="number">0.3</span>, <span class="prelude-val">None</span>)); <span class="comment">// ✅ This succeeds

</span><span class="kw">let </span>near_zero = <span class="number">1e-15</span>;
<span class="macro">assert!</span>(approx_zero(near_zero, <span class="prelude-val">None</span>)); <span class="comment">// ✅ Treated as zero</span></code></pre></div><h2 id="available-functions"><a class="doc-anchor" href="#available-functions">§</a>Available Functions</h2>
<ul>
<li><a href="fn.approx_eq.html" title="fn haze_library::utils::float_compare::approx_eq"><code>approx_eq</code></a> - Compare two f64 values for approximate equality</li>
<li><a href="fn.approx_zero.html" title="fn haze_library::utils::float_compare::approx_zero"><code>approx_zero</code></a> - Check if a value is approximately zero</li>
<li><a href="fn.approx_ne.html" title="fn haze_library::utils::float_compare::approx_ne"><code>approx_ne</code></a> - Check if two values are NOT approximately equal</li>
<li><a href="fn.relative_eq.html" title="fn haze_library::utils::float_compare::relative_eq"><code>relative_eq</code></a> - Compare with relative tolerance (better for large values)</li>
<li><a href="fn.safe_div.html" title="fn haze_library::utils::float_compare::safe_div"><code>safe_div</code></a> - Safe division that returns NaN for zero denominators</li>
<li><a href="fn.safe_div_or.html" title="fn haze_library::utils::float_compare::safe_div_or"><code>safe_div_or</code></a> - Safe division with custom default value</li>
</ul>
<h2 id="design-philosophy"><a class="doc-anchor" href="#design-philosophy">§</a>Design Philosophy</h2>
<ul>
<li><strong>KISS</strong>: Simple, focused functions for common comparison patterns</li>
<li><strong>YAGNI</strong>: Only implements necessary comparison operations</li>
<li><strong>SOLID</strong>: Single responsibility - each function does one thing well</li>
<li><strong>Occam’s Razor</strong>: Uses the simplest effective epsilon value (1e-10)</li>
</ul>
<h2 id="when-to-use"><a class="doc-anchor" href="#when-to-use">§</a>When to Use</h2>
<ul>
<li><strong>Always</strong> use these functions instead of <code>== 0.0</code>, <code>!= 0.0</code></li>
<li>Division guards: Check denominator before division</li>
<li>Threshold comparisons in indicators (RSI, Stochastic, etc.)</li>
<li>Matrix operations and linear algebra</li>
<li>Any calculation involving floating-point arithmetic</li>
</ul>
<h2 id="examples"><a class="doc-anchor" href="#examples">§</a>Examples</h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>haze_library::utils::float_compare::{approx_eq, approx_zero, relative_eq, safe_div};

<span class="comment">// Basic comparison
</span><span class="macro">assert!</span>(approx_eq(<span class="number">1.0</span>, <span class="number">1.0 </span>+ <span class="number">1e-15</span>, <span class="prelude-val">None</span>));

<span class="comment">// Zero checking (division guard)
</span><span class="kw">let </span>divisor = <span class="number">1e-12</span>;
<span class="kw">if </span>approx_zero(divisor, <span class="prelude-val">None</span>) {
    <span class="macro">println!</span>(<span class="string">"Denominator too small, avoiding division"</span>);
}

<span class="comment">// Relative comparison (better for large values)
</span><span class="kw">let </span>large_a = <span class="number">1e10</span>;
<span class="kw">let </span>large_b = <span class="number">1e10 </span>+ <span class="number">1.0</span>;
<span class="macro">assert!</span>(relative_eq(large_a, large_b, <span class="number">1e-9</span>));

<span class="comment">// Safe division
</span><span class="kw">let </span>result = safe_div(<span class="number">10.0</span>, <span class="number">0.0</span>); <span class="comment">// Returns NaN instead of panicking
</span><span class="macro">assert!</span>(result.is_nan());</code></pre></div><h2 id="performance-characteristics"><a class="doc-anchor" href="#performance-characteristics">§</a>Performance Characteristics</h2>
<ul>
<li>All comparison functions are <code>#[inline]</code> for zero-cost abstraction</li>
<li>O(1) time complexity for all operations</li>
<li>No heap allocations</li>
</ul>
<h2 id="cross-references"><a class="doc-anchor" href="#cross-references">§</a>Cross-References</h2>
<ul>
<li><a href="../math/index.html" title="mod haze_library::utils::math"><code>crate::utils::math</code></a> - Extended math utilities with Kahan summation</li>
<li><a href="../../indicators/index.html" title="mod haze_library::indicators"><code>crate::indicators</code></a> - Technical indicators using these comparisons</li>
<li><code>crate::ml</code> - Machine learning modules requiring precise comparisons</li>
</ul>
</div></details><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><dl class="item-table"><dt><a class="constant" href="constant.DEFAULT_EPSILON.html" title="constant haze_library::utils::float_compare::DEFAULT_EPSILON">DEFAULT_<wbr>EPSILON</a></dt><dd>Default epsilon for f64 comparisons (1e-10)</dd><dt><a class="constant" href="constant.RELAXED_EPSILON.html" title="constant haze_library::utils::float_compare::RELAXED_EPSILON">RELAXED_<wbr>EPSILON</a></dt><dd>Relaxed epsilon for loose comparisons (1e-8)</dd><dt><a class="constant" href="constant.STRICT_EPSILON.html" title="constant haze_library::utils::float_compare::STRICT_EPSILON">STRICT_<wbr>EPSILON</a></dt><dd>Stricter epsilon for critical calculations (1e-12)</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.approx_eq.html" title="fn haze_library::utils::float_compare::approx_eq">approx_<wbr>eq</a></dt><dd>Compare two f64 values for approximate equality.</dd><dt><a class="fn" href="fn.approx_ge.html" title="fn haze_library::utils::float_compare::approx_ge">approx_<wbr>ge</a></dt><dd>Check if a value is approximately greater than or equal to another value.</dd><dt><a class="fn" href="fn.approx_gt.html" title="fn haze_library::utils::float_compare::approx_gt">approx_<wbr>gt</a></dt><dd>Check if a value is approximately greater than another value.</dd><dt><a class="fn" href="fn.approx_le.html" title="fn haze_library::utils::float_compare::approx_le">approx_<wbr>le</a></dt><dd>Check if a value is approximately less than or equal to another value.</dd><dt><a class="fn" href="fn.approx_lt.html" title="fn haze_library::utils::float_compare::approx_lt">approx_<wbr>lt</a></dt><dd>Check if a value is approximately less than another value.</dd><dt><a class="fn" href="fn.approx_ne.html" title="fn haze_library::utils::float_compare::approx_ne">approx_<wbr>ne</a></dt><dd>Check if two values are NOT approximately equal.</dd><dt><a class="fn" href="fn.approx_not_zero.html" title="fn haze_library::utils::float_compare::approx_not_zero">approx_<wbr>not_<wbr>zero</a></dt><dd>Check if a value is NOT approximately zero.</dd><dt><a class="fn" href="fn.approx_zero.html" title="fn haze_library::utils::float_compare::approx_zero">approx_<wbr>zero</a></dt><dd>Check if a value is approximately zero.</dd><dt><a class="fn" href="fn.relative_eq.html" title="fn haze_library::utils::float_compare::relative_eq">relative_<wbr>eq</a></dt><dd>Compare two f64 values with relative tolerance.</dd><dt><a class="fn" href="fn.safe_div.html" title="fn haze_library::utils::float_compare::safe_div">safe_<wbr>div</a></dt><dd>Safe division that returns NaN when the denominator is approximately zero.</dd><dt><a class="fn" href="fn.safe_div_or.html" title="fn haze_library::utils::float_compare::safe_div_or">safe_<wbr>div_<wbr>or</a></dt><dd>Safe division that returns a default value when the denominator is approximately zero.</dd></dl></section></div></main></body></html>